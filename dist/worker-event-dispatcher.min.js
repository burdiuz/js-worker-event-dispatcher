!function(e,t){"function"==typeof define&&define.amd?define(["EventDispatcher","MessagePortDispatcher"],t):"object"==typeof module&&module.exports?module.exports=t(require("EventDispatcher"),require("MessagePortDispatcher")):e.WorkerEventDispatcher=t(e.EventDispatcher,e.MessagePortDispatcher)}(this,function(e,t){function r(e){function r(t,r){e.postMessage(t,r)}t.call(this,e,r)}function n(e){function t(){e.port.start()}function n(){e.port.close()}r.call(this,e.port),this.start=t,this.close=n}function o(e){function t(e){var t;this.receiver.hasEventListener("worker:connect")&&(t=e.source||e.ports[0])}e.port;r.call(this,e),e.addEventListener("connect",t),e.addEventListener("message",WorkerEvent.createHandler(WorkerEvent.MESSAGE,_receiver))}function s(e){function t(){e.start()}function n(){e.close()}r.call(this,e),this.start=t,this.close=n}function c(t){function n(){return o.terminate()}var o=t||self;e.isObject(t)||(o=new Worker(String(t))),r.call(this,o),this.terminate=n}function i(e){e!==a&&c.call(this,e)}var a={},u={};return Object.defineProperties(u,{WEB_WORKER:{value:"web"},SHARED_WORKER:{value:"shared"},SHARED_WORKER_SERVER:{value:"sharedServer"},SHARED_WORKER_CLIENT:{value:"sharedClient"}}),n.prototype=new i(a),n.prototype.constructor=n,o.prototype=new i(a),o.prototype.constructor=o,s.prototype=new i(a),s.prototype.constructor=s,c.prototype=new i(a),c.prototype.constructor=c,i.WorkerType=u,i.create=function(e,t){var r=null;switch(t){default:case u.WEB_WORKER:r=new c(e);break;case u.SHARED_WORKER:r=new n(e);break;case u.SHARED_WORKER_SERVER:r=new o(e);break;case u.SHARED_WORKER_CLIENT:r=new s(e)}return r},i.self=function(){return new i(self)},i});