!function(e,t){"function"==typeof define&&define.amd?define(["EventDispatcher"],t):"object"==typeof module&&module.exports?module.exports=t(require("EventDispatcher")):e.WorkerEventDispatcher=t(e.EventDispatcher)}(this,function(e){function t(t){function n(t){try{var n=JSON.parse(t.data)}catch(r){return}e.isObject(n)&&n.hasOwnProperty("type")&&a.dispatchEvent(n)}function r(n,r,i){n=e.getEvent(n,r);var a=JSON.stringify(n);t.postMessage(a,i),s.dispatchEvent(n)}function i(){return t.terminate()}var s=new e,a=new e;this.addEventListener=a.addEventListener,this.hasEventListener=a.hasEventListener,this.removeEventListener=a.removeEventListener,this.removeAllEventListeners=a.removeAllEventListeners,this.dispatchEvent=r,this.terminate=i,Object.defineProperties(this,{sender:{value:s,enumerable:!1},receiver:{value:a,enumerable:!1}}),e.isObject(t)||(t=new Worker(String(t))),t.addEventListener("message",n)}return t.self=function(){return new t(self)},t});